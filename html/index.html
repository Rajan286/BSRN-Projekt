<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SLCP-Chat: SLCP-Chat Programm – Detaillierte Dokumentation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">SLCP-Chat
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">SLCP-Chat Programm – Detaillierte Dokumentation </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1 class="doxsection"><a class="anchor" id="intro"></a>
Einführung</h1>
<p>Dieses Projekt implementiert einen dezentralen Chat-Client basierend auf dem Simple Local Chat Protocol (SLCP). Ziel ist eine Peer-to-Peer-Kommunikation ohne zentralen Server, die Text- und Bildnachrichten im lokalen Netzwerk ermöglicht.</p>
<h1 class="doxsection"><a class="anchor" id="goals"></a>
Projektziele</h1>
<ul>
<li>Vollständige Umsetzung des SLCP-Protokolls: JOIN, LEAVE, WHO, KNOWUSERS, MSG, IMG, WHOIS</li>
<li>Dezentrale Discovery mittels Broadcast und lokaler Discovery-Dienste</li>
<li>Klare Trennung der Funktionalität in drei Prozesse:<ul>
<li>Benutzeroberfläche (ui.py)</li>
<li>Netzwerk-Modul (network.py, peer.py)</li>
<li>Discovery-Dienst (discovery.py)</li>
</ul>
</li>
<li>Konfiguration per TOML-Datei, editierbar über CLI</li>
<li>Robustheit: Wiederverwendbarer Port-Finder, Named Pipes (FIFO), Signal-Handling</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="arch"></a>
Architektur</h1>
<p>Die Software-Architektur besteht aus drei Hauptkomponenten:</p><ul>
<li>Discovery-Dienst: Beantwortet WHO-Anfragen, verwaltet aktive Peers, kommuniziert über UDP</li>
<li>Netzwerk-Modul: Sendet/empfängt SLCP-Nachrichten per UDP/TCP, verarbeitet JOIN/LEAVE/MSG/IMG/WHOIS</li>
<li>Benutzeroberfläche: CLI-Interface, leitet Befehle an Netzwerk-Modul weiter und zeigt Nachrichten</li>
</ul>
<p>Kommunikation erfolgt über:</p><ul>
<li>UDP-Broadcast (entweder 255.255.255.255 oder lokale Broadcast-Adresse, z.B. 192.168.178.255:whoisport) für Discovery</li>
<li>TCP-Unicast für Direktnachrichten (MSG, IMG) und WHOIS</li>
<li>Named Pipes (FIFO) für IPC zwischen UI und Netzwerkmodul</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="config"></a>
Konfiguration</h1>
<p>Die zentrale Konfigurationsdatei <span class="tt">config.toml</span> enthält folgende Parameter: </p><ul>
<li>handle Benutzername des Clients </li>
<li>port Start-Port für lokale UDP-/TCP-Sockets </li>
<li>whoisport UDP-Port für Discovery-Broadcasts </li>
<li>autoreply Automatische Abwesenheits-Antwort (leer = deaktiviert) </li>
<li>imagepath Verzeichnis zum Speichern empfangener Bilder</li>
</ul>
<p>Optional: zweite Konfiguration (<span class="tt">config2.toml</span>) zum schnellen Wechsel des Handles und Ports (Ordner: User2).</p>
<h1 class="doxsection"><a class="anchor" id="modules"></a>
Modulübersicht</h1>
<ul>
<li>common.py: Helferfunktionen, FIFO-Verwaltung, Logging, PID-Management</li>
<li>peer.py: Modelliert Peers mit Handle, IP und Port, unterstützt Vergleich/Hash</li>
<li>discovery.py: Discovery-Dienst (WHO, JOIN, LEAVE, KNOWUSERS)</li>
<li>network.py: Netzwerkmodul (MSG, IMG, WHOIS, TCP/UDP-Sockets)</li>
<li>ui.py: Kommandozeilen-UI, zeigt Nachrichten und empfängt Befehle</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="protocol"></a>
SLCP-Protokoll</h1>
<p>SLCP-Befehle (textbasiert, UTF-8, <br  />
-terminiert): </p><ul>
<li>JOIN &lt;Handle&gt; &lt;Port&gt; </li>
<li>LEAVE &lt;Handle&gt; </li>
<li>WHO </li>
<li>KNOWUSERS &lt;Handle1&gt; &lt;IP1&gt; &lt;Port1&gt;,... </li>
<li>MSG &lt;Handle&gt; &lt;Text&gt; </li>
<li>IMG &lt;Handle&gt; &lt;Size&gt; (gefolgt von Binärdaten) </li>
<li>WHOIS &lt;Handle&gt; (Antwort: IAM &lt;Handle&gt; &lt;IP&gt; &lt;Port&gt;)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="quickstart"></a>
Schneller Start mit Skript</h1>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line">gnome-terminal -- bash -c &quot;python3 discovery.py config.toml; exec bash&quot;</div>
<div class="line">gnome-terminal -- bash -c &quot;python3 network.py config.toml; exec bash&quot;</div>
<div class="line">gnome-terminal -- bash -c &quot;python3 ui.py; exec bash&quot;</div>
</div><!-- fragment --><p> Ausführbar: <span class="tt">chmod +x start_chat.sh</span></p>
<h1 class="doxsection"><a class="anchor" id="build"></a>
Abhängigkeiten &amp; Dokumentation</h1>
<ul>
<li><span class="tt">pip install toml</span></li>
<li>Dokumentation generieren: <span class="tt">doxygen Doxyfile</span> (HTML in <span class="tt">html/</span>)</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="aufgetretene"></a>
Fehler</h1>
<ul>
<li><b>ConfigNotFound</b>: Konfigurationsdatei nicht gefunden – Lösung: Pfad prüfen oder <span class="tt">--config</span>-Parameter setzen.</li>
<li><b>FIFOPermission</b>: Keine Berechtigung für FIFO-Erstellung oder -Zugriff – Lösung: Schreibrechte auf <span class="tt">PIPE_DIR</span> sicherstellen.</li>
<li><b>BrokenPipe</b>: BrokenPipe-Fehler beim Schreiben in FIFO – Lösung: Retry/Timeout implementieren.</li>
<li><b>UDPBlocked</b>: UDP-Broadcast blockiert (z.B. macOS Restriktionen) – Lösung: lokale Broadcast-Adresse (z.B. <span class="tt">192.168.178.255</span>) verwenden.</li>
<li><b>PortInUse</b>: Socket-Bind-Fehler (Port belegt) – Lösung: anderen Start-Port konfigurieren.</li>
<li><b>TCPTimeout</b>: Timeout beim TCP-Verbindungsaufbau oder -Akzeptieren – Lösung: Socket-Timeouts setzen und <span class="tt">socket.timeout</span> abfangen.</li>
<li><b>InvalidCommand</b>: Unbekannter SLCP-Befehl – Lösung: Syntax validieren und Warnungen loggen.</li>
<li><b>PartialImage</b>: Teilweiser Bildempfang – Lösung: empfangene Bytes mit <span class="tt">Size</span> abgleichen.</li>
<li><b>SignalHandlerFail</b>: Signalhandler nicht registriert – Lösung: <span class="tt">signal.signal()</span> vor <span class="tt">start()</span> aufrufen.</li>
<li><b>IPCError</b>: Fehler bei IPC via FIFO – Lösung: Ausnahmen abfangen und fehlende Pipes automatisch anlegen.</li>
<li><b>WinError 10488</b>: Socketadresse bereits genutzt – Lösung: Terminal neu starten.</li>
<li><b>Your branch is behind</b>: Branch veraltet – Lösung: <span class="tt">git pull</span> ausführen.</li>
<li><b>TypeError</b>: 'DiscoveryService' is not subscriptable – Lösung: Objekte als Liste übergeben.</li>
</ul>
<p>Screenshots einbinden (in <span class="tt">docs/Bilder</span>): </p><div class="image">
<img src="Discovery_bereits_gestartet.png" alt=""/>
<div class="caption">
Zwei Discovery-Instanzen</div></div>
 <div class="image">
<img src="Noch_nicht_gepullt.png" alt=""/>
<div class="caption">
Nicht gepullt vor Commit</div></div>
 <div class="image">
<img src="User_Falsch_übergeben.png" alt=""/>
<div class="caption">
Falsche Listenübergabe</div></div>
 <div class="image">
<img src="TOML_Downloaden.png" alt=""/>
<div class="caption">
Library fehlte</div></div>
<h1 class="doxsection"><a class="anchor" id="flow"></a>
Flussdiagramm der Hosts</h1>
<p>Ablauf auf zwei Hosts im selben WLAN:</p><ul>
<li>Host A: startet discovery.py, network.py, ui.py</li>
<li>Host B: ebenso, mit eigener config</li>
</ul>
<p>Kommunikation:</p><ul>
<li>UDP-Broadcast WHO → Discovery</li>
<li>UDP-Reply KNOWUSERS</li>
<li>TCP-Unicast für MSG/IMG/WHOIS</li>
<li>FIFO für UI-Netzwerkkommunikation</li>
</ul>
<h1 class="doxsection"><a class="anchor" id="flow"></a>
Flussdiagramm der Hosts</h1>
<div class="dotgraph">
<img src="dot_inline_dotgraph_1.png" alt="dot_inline_dotgraph_1.png" border="0" usemap="#dot_inline_dotgraph_1.map"/>
</div>
<h1 class="doxsection"><a class="anchor" id="authors"></a>
Autoren</h1>
<ul>
<li>Rajan Kakkar (1538362)</li>
<li>Zufar Reyal (1417498)</li>
<li>Soufian Kenbouche (1574324)</li>
<li>Bileya Karimou (1570665)</li>
<li>Yasmin Hammouni (1514652) </li>
</ul>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
